var ACCOUNT={login:"",password:"",name:"",ftp:!1,urlFtp:"",urlPhp:""},SETTINGS_DECLARE=[],N_SETTINGS=function(){var o=this;o.I={},SETTINGS_DECLARE=[],TEMP_SETTINGS_DECLARE.all(function(t){var e={},o={};for(var n in t)t[n].constructor===Object&&t[n]._InitClass?(o[n]=t[n]._InitClass,e.Ainit(o)):e[n]=t[n];SETTINGS_DECLARE.push(e)}),SETTINGS_DECLARE.all(function(t){var e=t.param;e&&(e.iteration?o.I[e.name]=e.def:o[e.name]=e.def)})},E_SETTINGS=function(){var o=window.BUFFER.localData.settings;o.I=o.I||{},SETTINGS_DECLARE=[],TEMP_SETTINGS_DECLARE.all(function(t){var e={},o={};for(var n in t)t[n].constructor===Object&&t[n]._InitClass?(o[n]=t[n]._InitClass,e.Ainit(o)):e[n]=t[n];SETTINGS_DECLARE.push(e)}),SETTINGS_DECLARE.all(function(t){var e=t.param;e&&(e.iteration?o.I[e.name]=void 0!==o.I[e.name]?o.I[e.name]:e.def:o[e.name]=void 0!==o[e.name]?o[e.name]:e.def)})},N_LOCAL=function(){var t=this;t.accounts={name:[],login:[],password:[],ftp:[],urlPhp:[],urlFtp:[],portFtp:[],data:{explorer:{}}},t.settings=new N_SETTINGS,t.version=VERSION,t.UIStatics={resizePanels:{}}},N_BUFFER=function(){this.localData=new N_LOCAL,this.explorer={back:[],copied:[],copiedCut:!1,forward:[],curDir:"@ROOT:",tree:{"@ROOT:":{type:"dir",list:{},opened:!1,parent:null,url:"@ROOT:"}}},this.downloads={},this.redactors={},this.windows={viewInReload:{},redactors:{}},this.loadprocess={reloadDownloads:A.start(function(){},!0),openDir:A.start(),reloadTree:A.start(),setHash:A.start()}},BUFFER=new N_BUFFER,BUFFERToLocal=function(){""!==ACCOUNT.name&&(BUFFER.localData.accounts.data.explorer[ACCOUNT.name]=BUFFER.explorer),localStorage.setItem(PRCON_LOCAL_STORAGE_NAME,A.json(BUFFER.localData))},localToBUFFER=function(){BUFFER.localData=A.json(localStorage.getItem(PRCON_LOCAL_STORAGE_NAME)),BUFFER.explorer=BUFFER.localData.accounts.data.explorer[ACCOUNT.name]||(new N_BUFFER).explorer},clearLocal=function(){localStorage.setItem(PRCON_LOCAL_STORAGE_NAME,A.json(new N_LOCAL)),localToBUFFER(),localStorage.removeItem(PRCON_LANGUAGE_SAVE_NAME),localStorage.removeItem(PRCON_REDACTOR_CURRENT_NAME),window.location.reload()},getAccRow=function(o){var t,n=-1;return BUFFER.localData.accounts.name.all(function(t,e){if(t===o)return n=e,"break"},"break"),t=BUFFER.localData.accounts,{index:n,row:{name:o,login:t.login[n],password:t.password[n],ftp:t.ftp[n],urlPhp:t.urlPhp[n],urlFtp:t.urlFtp[n],portFtp:t.portFtp[n]}}},setAccount=function(t,e,o,n,a,r,l){if(UI.closeAll(),t.constructor===Object)for(var i in t)ACCOUNT[i]=t[i];else ACCOUNT.ftp=e,ACCOUNT.login=o,ACCOUNT.password=n,ACCOUNT.urlPhp=a,ACCOUNT.urlFtp=r,ACCOUNT.name=t,ACCOUNT.portFtp=l;localToBUFFER(),UI.parseTree(),UI.openDir(!1,!1,"stay")},objWalk=function(t,o,n,a){var r=t;return o.all(function(t,e){if(void 0===r||!(t in r))return r=void 0,"break";r=r[t],!n||a&&e===o.length-1||(r=objWalk(r,n))},"break"),r},applySettings=function(){var t=BUFFER.localData.settings;"body".opt(t.I)},b64toBlob=function(t,e,o){e=e||"",o=o||512;for(var n=atob(t),a=[],r=0;r<n.length;r+=o){for(var l=n.slice(r,r+o),i=new Array(l.length),c=0;c<l.length;c++)i[c]=l.charCodeAt(c);var s=new Uint8Array(i);a.push(s)}return new Blob(a,{type:e})},BlobToB64=function(o){return A.start(function(t){var e=new FileReader;e.onloadend=function(){t.value=e.result},e.readAsDataURL(o)})},getFile=function(t,e,o){var n,a;switch(Object.__typeOf__(t)){case"undefined":return!1;case"String":n=window.URL.createObjectURL(new Blob([t],{type:o}));break;case"Blob":n=window.URL.createObjectURL(t);break;default:n=window.URL.createObjectURL(new Blob(t,{type:o}))}return(a="body".addElem("a",{href:n,download:e})).click(),setTimeout(function(){a.remElem(),window.URL.revokeObjectURL(n)},0),!0},queryFiles=function(){var n,a,r=function(){a(n.files),n.removeEventListener("input",r),n.remove&&n.remove()};return function(t,e,o){n&&n.removeEventListener("input",r),n&&n.remove&&n.remove(),n=A.createElem("input",{type:"file",accept:o||"",multiple:e?"true":""}),a=t,n.addEventListener("input",r),n.click()}}(),pendTo=function(o){var n;return A.start(function(e){!function t(){if(!(n=o()))return setTimeout(t,0);e.value=n}()},!0)};!function(){var t;(!localStorage.getItem(PRCON_LOCAL_STORAGE_NAME)||A.isEmpty(t=A.json(localStorage.getItem(PRCON_LOCAL_STORAGE_NAME)))||0<VERSION&&t.version!==VERSION)&&localStorage.setItem(PRCON_LOCAL_STORAGE_NAME,A.json(new N_LOCAL)),localToBUFFER()}(),window.history&&BUFFER.localData.settings.enableUseBrowserBFBtns&&(history.pushState("back",document.title,location.href),history.pushState("stay",document.title,location.href),history.pushState("forward",document.title,location.href),history.back(),window.addEventListener("popstate",function(t){"back"===t.state?(history.forward(),UI.goBack()):"forward"===t.state&&(history.back(),UI.goForward())})),window.addEventListener("hashchange",function(){BUFFER.loadprocess.setHash=BUFFER.loadprocess.setHash.wait(function(t,e){if("setJS"===t)return e.value=!0;console.log(33),pendTo(function(){return window.UI.openDir}).wait(function(t){t(!1,window.location.hash.substr(1)),e.value=!0})},!0)}),window.addEventListener("unload",BUFFERToLocal,!1),window.addEventListener("beforeunload",BUFFERToLocal,!1),window.addEventListener("unload",function(){window.UI.closeAll()},!1);
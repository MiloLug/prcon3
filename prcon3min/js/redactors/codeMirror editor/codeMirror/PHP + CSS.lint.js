!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("php-parser")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","php-parser"],e):e(CodeMirror,PhpParser)}(function(m,e,a){"use strict";if(!window.CSSLint)return window.console&&window.console.error("Error: window.CSSLint not defined, CodeMirror HTML mixed linting cannot run."),found;function h(e){return e.split("\n").length}function l(e,r,n,i,o){var t,s;n.lineNumber&&n.columnNumber?(t=m.Pos(e-1+n.lineNumber-1,n.columnNumber-1),s=m.Pos(e-1+n.lineNumber-1,n.columnNumber)):n.start&&n.end&&(n.end.offset<n.start.offset?(s=m.Pos(e-1+n.start.line-1,n.start.column),t=m.Pos(e-1+n.end.line-1,n.end.column)):(t=m.Pos(e-1+n.start.line-1,n.start.column),s=m.Pos(e-1+n.end.line-1,n.end.column))),o.push({message:r,severity:i,from:t,to:s})}function d(r,e,n,i){for(var o in e.hasOwnProperty("kind")&&function(e,r,n,i){if(n.disableEval){if("eval"===r.kind)return l(e,"Eval is evil",r.loc,"warning",i);if("call"===r.kind&&"create_function"===r.what.name)return l(e,"Eval is evil",r.loc,"warning",i)}if("exit"===r.kind&&n.disableExit)return l(e,"You should not use exit or die",r.loc,"warning",i);if(n.disablePHP7&&"array"===r.kind&&r.shortForm)return l(e,"PHP 7 feature disabled",r.loc,"warning",i);if(n.disabledFunctions&&"call"===r.kind&&-1<n.disabledFunctions.indexOf(r.what.name))return l(e,'Function "'+r.what.name+'" is not available',r.what.loc,"error",i);if(n.deprecatedFunctions&&"call"===r.kind&&-1<n.deprecatedFunctions.indexOf(r.what.name))l(e,'Function "'+r.what.name+'" is deprecated',r.what.loc,"warning",i)}(r,e,n,i),e)if(e.hasOwnProperty(o)){var t=e[o];if(!t)continue;t.hasOwnProperty("kind")?d(r,t,n,i):Array.isArray(t)?t.forEach(function(e){d(r,e,n,i)}):"object"==typeof t&&d(r,t,n,i)}}m.registerHelper("lint","html",function(e,r){var n=[],i=function(e){var r,n=0,i=e.split(/<\?|\?>/gi),o={};e="";for(var t,s,a=0,l=i.length;a<l;a+=2){n+=void 0!==(r=i[a-1])?h(r):0,t=e.indexOf("\n")<0?0:h(e),s=h(i[a]),e+=i[a];for(var d=0,c=s+1;d<c;d++)o[t+d]=0<n?n-a/2*1:0}return{t:e,o:o}}(e);r.indent||(r.indent=1);var o=r.css||JSON.parse(JSON.stringify(r)),t=r.php||JSON.parse(JSON.stringify(r));return function(e,r,n){for(var i=e.t.split(/<style[\s\S]*?>|<\/style>/gi),o=0,t=1;t<i.length;t+=2){var s=h(i.slice(0,t).join()),a=CSSLint.verify(i[t],r).messages,l=null;o=e.o[s]||o;for(var d=0;d<a.length;d++){var c=o+s-1+(l=a[d]).line-1,u=o+s-1+l.line-1,f=l.col-1,p=l.col;n.push({from:m.Pos(c,f),to:m.Pos(u,p),message:l.message,severity:l.type})}}}(i,o,n),function(e,r,n){if(a){var i,o,t=a.parseCode(e,{parser:{suppressErrors:!0},ast:{withPositions:!0}});if(t.messages,t.errors&&0<t.errors.length)for(var s=0;s<t.errors.length;s++)i=(o=t.errors[s]).loc,l(1,o.message,i,"error",n);d(1,t,r,n)}else window.console&&window.console.error("Error: php-parser not defined, CodeMirror PHP linting cannot run.")}(e,t,n),n})});
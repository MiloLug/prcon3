!function(r){"object"==typeof exports&&"object"==typeof module?r(require("../../lib/codemirror"),require("php-parser")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","php-parser"],r):r(CodeMirror,PhpParser)}(function(d,a){"use strict";if(!window.JSHINT)return window.console&&window.console.error("Error: window.JSHINT not defined, CodeMirror HTML mixed linting cannot run."),[];function l(r,e,n){for(var i=0;i<r.length;i++){var o=r[i];if(o){if(o.line<=0){window.console&&window.console.warn("Cannot display JSHint error (invalid line "+o.line+")",o);continue}var t=o.character-1,s=t+1;if(o.evidence){var a=o.evidence.substring(t).search(/.\b/);-1<a&&(s+=a)}var l=o.line-1+n-1,c={message:o.reason,severity:o.code&&o.code.startsWith("W")?"warning":"error",from:d.Pos(l,t),to:d.Pos(l,s)};e.push(c)}}}function f(r){return r.split("\n").length}function c(r,e,n,i,o){var t,s;n.lineNumber&&n.columnNumber?(t=d.Pos(r-1+n.lineNumber-1,n.columnNumber-1),s=d.Pos(r-1+n.lineNumber-1,n.columnNumber)):n.start&&n.end&&(n.end.offset<n.start.offset?(s=d.Pos(r-1+n.start.line-1,n.start.column),t=d.Pos(r-1+n.end.line-1,n.end.column)):(t=d.Pos(r-1+n.start.line-1,n.start.column),s=d.Pos(r-1+n.end.line-1,n.end.column))),o.push({message:e,severity:i,from:t,to:s})}function u(e,r,n,i){for(var o in r.hasOwnProperty("kind")&&function(r,e,n,i){if(n.disableEval){if("eval"===e.kind)return c(r,"Eval is evil",e.loc,"warning",i);if("call"===e.kind&&"create_function"===e.what.name)return c(r,"Eval is evil",e.loc,"warning",i)}if("exit"===e.kind&&n.disableExit)return c(r,"You should not use exit or die",e.loc,"warning",i);if(n.disablePHP7&&"array"===e.kind&&e.shortForm)return c(r,"PHP 7 feature disabled",e.loc,"warning",i);if(n.disabledFunctions&&"call"===e.kind&&-1<n.disabledFunctions.indexOf(e.what.name))return c(r,'Function "'+e.what.name+'" is not available',e.what.loc,"error",i);if(n.deprecatedFunctions&&"call"===e.kind&&-1<n.deprecatedFunctions.indexOf(e.what.name))c(r,'Function "'+e.what.name+'" is deprecated',e.what.loc,"warning",i)}(e,r,n,i),r)if(r.hasOwnProperty(o)){var t=r[o];if(!t)continue;t.hasOwnProperty("kind")?u(e,t,n,i):Array.isArray(t)?t.forEach(function(r){u(e,r,n,i)}):"object"==typeof t&&u(e,t,n,i)}}d.registerHelper("lint","html",function(r,e){var n=[],i=function(r){var e,n=0,i=r.split(/<\?|\?>/gi),o={};r="";for(var t,s,a=0,l=i.length;a<l;a+=2){n+=void 0!==(e=i[a-1])?f(e):0,t=r.indexOf("\n")<0?0:f(r),s=f(i[a]),r+=i[a];for(var c=0,d=s+1;c<d;c++)o[t+c]=0<n?n-a/2*1:0}return{t:r,o:o}}(r);e.indent||(e.indent=1);var o=e.js||JSON.parse(JSON.stringify(e)),t=e.php||JSON.parse(JSON.stringify(e));return o.esversion=6,function(r,e,n){if(a){var i,o,t=a.parseCode(r,{parser:{suppressErrors:!0},ast:{withPositions:!0}});if(t.messages,t.errors&&0<t.errors.length)for(var s=0;s<t.errors.length;s++)i=(o=t.errors[s]).loc,c(1,o.message,i,"error",n);u(1,t,e,n)}else window.console&&window.console.error("Error: php-parser not defined, CodeMirror PHP linting cannot run.")}(r,t,n),function(r,e,n){for(var i=r.t.split(/<script[\s\S]*?>|<\/script>/gi),o=1;o<i.length;o+=2)if(1<i[o].length){JSHINT(i[o],e,e.globals);var t=JSHINT.data().errors,s=f(i.slice(0,o).join());t&&l(t,n,s+r.o[s])}}(i,o,n),n})});
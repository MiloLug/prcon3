!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("htmlhint"),require("php-parser")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","htmlhint","php-parser"],e):e(CodeMirror,window.HTMLHint,PhpParser)}(function(f,p,s){"use strict";var m={"tagname-lowercase":!0,"attr-lowercase":!0,"attr-value-double-quotes":!0,"doctype-first":!1,"tag-pair":!0,"spec-char-escape":!0,"id-unique":!0,"src-not-empty":!0,"attr-no-duplication":!0};if(p&&!p.verify&&(p=p.HTMLHint),p||(p=window.HTMLHint),!p)return window.console&&window.console.error("Error: window.HTMLHint not found, CodeMirror HTML mixed linting cannot run."),[];function d(e){return e.split("\n").length}function l(e,r,n,i,o){var t,a;n.lineNumber&&n.columnNumber?(t=f.Pos(e-1+n.lineNumber-1,n.columnNumber-1),a=f.Pos(e-1+n.lineNumber-1,n.columnNumber)):n.start&&n.end&&(n.end.offset<n.start.offset?(a=f.Pos(e-1+n.start.line-1,n.start.column),t=f.Pos(e-1+n.end.line-1,n.end.column)):(t=f.Pos(e-1+n.start.line-1,n.start.column),a=f.Pos(e-1+n.end.line-1,n.end.column))),o.push({message:r,severity:i,from:t,to:a})}function c(r,e,n,i){for(var o in e.hasOwnProperty("kind")&&function(e,r,n,i){if(n.disableEval){if("eval"===r.kind)return l(e,"Eval is evil",r.loc,"warning",i);if("call"===r.kind&&"create_function"===r.what.name)return l(e,"Eval is evil",r.loc,"warning",i)}if("exit"===r.kind&&n.disableExit)return l(e,"You should not use exit or die",r.loc,"warning",i);if(n.disablePHP7&&"array"===r.kind&&r.shortForm)return l(e,"PHP 7 feature disabled",r.loc,"warning",i);if(n.disabledFunctions&&"call"===r.kind&&-1<n.disabledFunctions.indexOf(r.what.name))return l(e,'Function "'+r.what.name+'" is not available',r.what.loc,"error",i);if(n.deprecatedFunctions&&"call"===r.kind&&-1<n.deprecatedFunctions.indexOf(r.what.name))l(e,'Function "'+r.what.name+'" is deprecated',r.what.loc,"warning",i)}(r,e,n,i),e)if(e.hasOwnProperty(o)){var t=e[o];if(!t)continue;t.hasOwnProperty("kind")?c(r,t,n,i):Array.isArray(t)?t.forEach(function(e){c(r,e,n,i)}):"object"==typeof t&&c(r,t,n,i)}}f.registerHelper("lint","html",function(e,r){var n=[],i=function(e){var r,n=0,i=e.split(/<\?|\?>/gi),o={};e="";for(var t,a,s=0,l=i.length;s<l;s+=2){n+=void 0!==(r=i[s-1])?d(r):0,t=e.indexOf("\n")<0?0:d(e),a=d(i[s]),e+=i[s];for(var c=0,u=a+1;c<u;c++)o[t+c]=0<n?n-s/2*1:0}return{t:e,o:o}}(e);r.indent||(r.indent=1);var o=r.html||JSON.parse(JSON.stringify(r)),t=r.php||JSON.parse(JSON.stringify(r));return function(e,r,n){for(var i=e.t,o=p.verify(i,r&&r.rules||m),t=0,a=0;a<o.length;a++){var s=o[a],l=(t=e.o[s.line]||t)+s.line-1,c=t+s.line-1,u=s.col-1,d=s.col;n.push({from:f.Pos(l,u),to:f.Pos(c,d),message:s.message,severity:s.type})}}(i,o,n),function(e,r,n){if(s){var i,o,t=s.parseCode(e,{parser:{suppressErrors:!0},ast:{withPositions:!0}});if(t.messages,t.errors&&0<t.errors.length)for(var a=0;a<t.errors.length;a++)i=(o=t.errors[a]).loc,l(1,o.message,i,"error",n);c(1,t,r,n)}else window.console&&window.console.error("Error: php-parser not defined, CodeMirror PHP linting cannot run.")}(e,t,n),n})});
window.UI.ctx={openContextmenu:function(e,t,n){var l=A.args({content:[{type:"message",text:"hmm...."},{type:"line"},{type:"button",btntext:"test btn",btnID:"test1"}],func:function(){}},e),a=UID.get(),r=n?".contextmenu".a(!0).end.addClass("preshow"):"body".addElem("div",{class:"contextmenu preshow",uid:a,_CSS:{top:t.Y+"px",left:t.X+"px"},_TXT:"<f-scrollplane></f-scrollplane><f-scroll-y><f-wheel></f-wheel></f-scroll-y>"}),o=r.child("f-scrollplane"),c=function(e,t){t=e.toElement.opt("bid"),UI.ctx.closeContextmenu(r.opt("uid")),l.func&&l.func({pressed:t})};n&&o.addElem("hr"),l.content.all(function(e){switch(e.type){case"message":o.addElem("div",{class:"message",_TXT:e.text}).opt(e.opt||{});break;case"button":o.addElem("button",{class:"blackbtn txtnowrap"+(!1===e.click?" noclick":""),_TXT:e.btntext,bid:e.btnID,ofCtxUID:a,funcs:e.funcs?e.funcs:"",_LIS:!1===e.click?[]:[{click:c}]}).opt(e.opt||{});break;case"line":o.addElem("hr",e.opt||{})}}),(o=[r.getBoundingClientRect(),"body".a().getBoundingClientRect()])[0].height+t.Y>o[1].height&&r.css("top",((o[2]=o[1].height-o[0].height)>o[1].height?o[1].height-o[1].height/10:o[2])+"px"),o[0].width+t.X>o[1].width&&r.css("left",((o[2]=o[1].width-o[0].width)>o[1].width?o[1].width-o[1].width/10:o[2])+"px"),r.remClass("preshow")},closeContextmenu:function(e){("[uid="+e+"]").remElem()},treeMenu:function(l,e,t){var n={content:[],func:function(e){var t=e.pressed,n=l.attrFromPath("_url");switch(t){case"reloadInTree":UI.reloadListsChanges(l,n,"tree")}}};"true"===l.opt("opened")&&n.content.push({type:"button",btntext:"Reload".tr,btnID:"reloadInTree"}),UI.ctx.openContextmenu(n,e,t)},dirFileMenu:function(n,e,t){var l=n.hasClass("selected"),a=n.attrFromPath("_url"),r=PATH(a).divNameExt()[1],o=n.attrFromPath("_type"),c=".dirPlace.selected".all(function(e){return e.attrFromPath("_url")}).return,i={content:["file"===o?{type:"button",btntext:"Edit".tr,btnID:"edit"+(l?"all":"")}:{},{type:"button",btntext:"Copy".tr,btnID:"copy"+(l?"all":"")},{type:"button",btntext:"Cut".tr,btnID:"cut"+(l?"all":"")},{type:"button",btntext:"Copy".tr+" URL",btnID:"copyurl"+(l?"all":"")},"dir"===o?{type:"button",click:!!BUFFER.explorer.copied.length,btntext:"Paste".tr,btnID:"paste"}:{},"file"===o?{type:"button",btntext:"Download".tr,btnID:"download"+(l?"all":"")}:{},{type:"line"},{type:"button",btntext:"Add to archive".tr,btnID:"addZip"+(l?"all":"")},"zip"===r?{type:"button",btntext:"Exzip".tr,btnID:"exzip"}:{},{type:"line"},{type:"button",btntext:"Delete".tr,btnID:"delete"+(l?"all":"")},{type:"button",btntext:"Rename".tr,btnID:"rename"+(l?"all":"")}],func:function(e){switch(e.pressed){case"delete":UI.deleteDirFile(n,a);break;case"edit":UI.openFile(n,a);break;case"editall":".dirPlace.selected".all(function(e){"file"===e.attrFromPath("_type")&&UI.openFile(n,e.attrFromPath("_url"))});break;case"deleteall":UI.deleteAllList(n,c);break;case"copy":BUFFER.explorer.copied=[a],BUFFER.explorer.copiedCut=!1;break;case"cut":BUFFER.explorer.copied=[a],BUFFER.explorer.copiedCut=!0;break;case"cutall":BUFFER.explorer.copied=c,BUFFER.explorer.copiedCut=!0;break;case"copyurl":UI.copyText(n,a);break;case"copyurlall":UI.copyText(n,c.join("\n"));break;case"copyall":BUFFER.explorer.copied=c,BUFFER.explorer.copiedCut=!1;break;case"paste":UI.paste(n,{list:BUFFER.explorer.copied,destinationDir:a,deleteSource:BUFFER.explorer.copiedCut});break;case"addZip":UI.createZip(n,PATH(a).parentDir,[a]);break;case"addZipall":UI.createZip(n,PATH(c[0]).parentDir,c);break;case"rename":var t=PATH(a);UI.rename(n,t.parentDir,[t.name]);break;case"renameall":UI.rename(n,PATH(c[0]).parentDir,c.all(function(e){return PATH(e).name}).return);break;case"download":UI.download(n,[a]);break;case"downloadall":c=[],".dirPlace.selected".all(function(e){"file"===e.attrFromPath("_type")&&c.push(e.attrFromPath("_url"))}),UI.download(n,c);break;case"exzip":UI.extractZip(n,a)}}};UI.ctx.openContextmenu(i,e,t)},rightexplorer:function(o,e,t){var n={content:[{type:"button",btntext:"Create file".tr,btnID:"mkfile"},{type:"button",btntext:"Create dir".tr,btnID:"mkdir"},{type:"button",click:!!BUFFER.explorer.copied.length,btntext:"Paste".tr,btnID:"paste"},{type:"button",btntext:"Reload".tr,btnID:"reload"},{type:"button",btntext:"Upload".tr,btnID:"upload"}],func:function(e){var t=e.pressed,r=o.attrFromPath("_url");switch(t){case"mkdir":UI.createDir(o,r);break;case"mkfile":UI.createFile(o,r);break;case"reload":UI.openDir(document,r,"stay");break;case"upload":UI.dialogPanel({content:[{type:"message",text:"select files".tr+":"},{type:"uploader",upltext:"...",uplID:"files",multiple:!0},{type:"button",btntext:"ok".tr,btnID:"ok"},{type:"button",btntext:"cancel".tr,btnID:"cl"}],onEnter:"ok",func:function(e){if("ok"===e.pressed&&e.fileLists.files[0]){for(var t=[],n=e.fileLists.files,l=0,a=n.length;l<a;l++)t.push(n[l]);UI.upload(o,t,r)}}});break;case"paste":UI.paste(o,{list:BUFFER.explorer.copied,destinationDir:r,deleteSource:BUFFER.explorer.copiedCut})}}};UI.ctx.openContextmenu(n,e)},loginLocalListItem:function(t,e,n){var l=t.hasClass("selected"),a=t.opt("name"),r="[act=loginLocal] .forsel.selected".all(function(e){return e.opt("name")}).return,o={content:[{type:"button",btntext:"Delete".tr,btnID:"del"}],func:function(e){switch(e.pressed){case"del":UI.deleteAccs(t,l?r:[a])}}};UI.ctx.openContextmenu(o,e)}};